<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visual Integration Tests - Rope & Pulley Simulator</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <style>
        .test-panel {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--gradient-surface);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-xl);
            padding: var(--spacing-xl);
            width: 300px;
            box-shadow: var(--shadow-lg);
            z-index: 100;
        }

        .test-btn {
            width: 100%;
            margin: 8px 0;
            padding: 12px;
            background: var(--gradient-primary);
            border: none;
            border-radius: var(--radius-md);
            color: white;
            font-family: var(--font-family);
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-base);
        }

        .test-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-glow);
        }

        .test-btn.secondary {
            background: var(--color-surface);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        h2 {
            color: var(--color-primary-light);
            margin-bottom: 16px;
            font-size: 1.2rem;
        }

        .test-description {
            color: var(--color-text-secondary);
            font-size: 0.85rem;
            margin: 4px 0 12px 0;
        }
    </style>
</head>

<body>
    <div class="container">
        <header class="header">
            <div class="header-content">
                <h1 class="title">
                    <svg class="title-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10" />
                        <circle cx="12" cy="12" r="3" />
                    </svg>
                    Visual Integration Tests
                </h1>
                <p class="subtitle">Click buttons to run physics tests</p>
            </div>
        </header>

        <main class="main-content">
            <div class="canvas-container">
                <canvas id="canvas"></canvas>
            </div>
        </main>

        <!-- Test Panel -->
        <div class="test-panel">
            <h2>üß™ Test Scenarios</h2>

            <button class="test-btn" onclick="testSimplePulley()">
                Simple Pulley System
            </button>
            <div class="test-description">Anchor ‚Üí Pulley ‚Üí Weight</div>

            <button class="test-btn" onclick="testDoublePulley()">
                Double Pulley System
            </button>
            <div class="test-description">Two pulleys with shared weight</div>

            <button class="test-btn" onclick="testHangingWeight()">
                Hanging Weight
            </button>
            <div class="test-description">Direct anchor to weight</div>

            <button class="test-btn" onclick="testGridAlignment()">
                Grid Alignment Test
            </button>
            <div class="test-description">Objects at grid intersections</div>

            <button class="test-btn secondary" onclick="clearScene()">
                üóëÔ∏è Clear Scene
            </button>

            <button class="test-btn secondary" onclick="location.href='index.html'">
                ‚Üê Back to Simulator
            </button>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
    <script src="config.js"></script>
    <script src="app.js"></script>
    <script>
        console.log('üß™ Visual test page loading...');

        function clearScene() {
            if (typeof App !== 'undefined' && App.engine) {
                Matter.Composite.clear(App.engine.world);
                App.objects = [];
                createGround();
                console.log('üóëÔ∏è Scene cleared');
            }
        }

        function testSimplePulley() {
            clearScene();
            console.log('üß™ Running: Simple Pulley System');
            const cfg = ObjectConfig;

            const anchor = Matter.Bodies.rectangle(400, 100, cfg.anchor.width, cfg.anchor.height, {
                isStatic: true,
                render: { fillStyle: cfg.anchor.fillColor, strokeStyle: cfg.anchor.strokeColor, lineWidth: cfg.anchor.lineWidth },
                label: 'anchor'
            });

            const pulley = Matter.Bodies.circle(400, 250, cfg.pulley.radius, {
                isStatic: true,
                render: { fillStyle: cfg.pulley.fillColor, strokeStyle: cfg.pulley.strokeColor, lineWidth: cfg.pulley.lineWidth },
                label: 'pulley'
            });

            const weight = Matter.Bodies.rectangle(400, 450, cfg.weight.size, cfg.weight.size, {
                density: 0.1,
                render: { fillStyle: cfg.weight.fillColor, strokeStyle: cfg.weight.strokeColor, lineWidth: cfg.weight.lineWidth },
                label: 'weight'
            });

            Matter.Composite.add(App.engine.world, [anchor, pulley, weight]);
            createRope({ x: 400, y: 110, body: anchor }, { x: 400, y: 220, body: pulley });
            createRope({ x: 400, y: 280, body: pulley }, { x: 400, y: 430, body: weight });

            Matter.Runner.run(App.runner, App.engine);
            App.isSimulating = true;
            console.log('‚úÖ Test running!');
        }

        function testDoublePulley() {
            clearScene();
            console.log('üß™ Running: Double Pulley System');
            const cfg = ObjectConfig;

            const anchor1 = Matter.Bodies.rectangle(250, 100, cfg.anchor.width, cfg.anchor.height, {
                isStatic: true,
                render: { fillStyle: cfg.anchor.fillColor, strokeStyle: cfg.anchor.strokeColor, lineWidth: cfg.anchor.lineWidth },
                label: 'anchor'
            });

            const anchor2 = Matter.Bodies.rectangle(550, 100, cfg.anchor.width, cfg.anchor.height, {
                isStatic: true,
                render: { fillStyle: cfg.anchor.fillColor, strokeStyle: cfg.anchor.strokeColor, lineWidth: cfg.anchor.lineWidth },
                label: 'anchor'
            });

            const pulley1 = Matter.Bodies.circle(250, 250, cfg.pulley.radius, {
                isStatic: true,
                render: { fillStyle: cfg.pulley.fillColor, strokeStyle: cfg.pulley.strokeColor, lineWidth: cfg.pulley.lineWidth },
                label: 'pulley'
            });

            const pulley2 = Matter.Bodies.circle(550, 250, cfg.pulley.radius, {
                isStatic: true,
                render: { fillStyle: cfg.pulley.fillColor, strokeStyle: cfg.pulley.strokeColor, lineWidth: cfg.pulley.lineWidth },
                label: 'pulley'
            });

            const weight = Matter.Bodies.rectangle(400, 450, 60, cfg.weight.size, {
                density: 0.15,
                render: { fillStyle: cfg.weight.fillColor, strokeStyle: cfg.weight.strokeColor, lineWidth: cfg.weight.lineWidth },
                label: 'weight'
            });

            Matter.Composite.add(App.engine.world, [anchor1, anchor2, pulley1, pulley2, weight]);
            createRope({ x: 250, y: 110, body: anchor1 }, { x: 250, y: 220, body: pulley1 });
            createRope({ x: 250, y: 280, body: pulley1 }, { x: 370, y: 430, body: weight });
            createRope({ x: 550, y: 110, body: anchor2 }, { x: 550, y: 220, body: pulley2 });
            createRope({ x: 550, y: 280, body: pulley2 }, { x: 430, y: 430, body: weight });

            Matter.Runner.run(App.runner, App.engine);
            App.isSimulating = true;
            console.log('‚úÖ Test running!');
        }

        function testHangingWeight() {
            clearScene();
            console.log('üß™ Running: Hanging Weight');
            const cfg = ObjectConfig;

            const anchor = Matter.Bodies.rectangle(400, 100, cfg.anchor.width, cfg.anchor.height, {
                isStatic: true,
                render: { fillStyle: cfg.anchor.fillColor, strokeStyle: cfg.anchor.strokeColor, lineWidth: cfg.anchor.lineWidth },
                label: 'anchor'
            });

            const weight = Matter.Bodies.rectangle(400, 350, cfg.weight.size, cfg.weight.size, {
                density: 0.1,
                render: { fillStyle: cfg.weight.fillColor, strokeStyle: cfg.weight.strokeColor, lineWidth: cfg.weight.lineWidth },
                label: 'weight'
            });

            Matter.Composite.add(App.engine.world, [anchor, weight]);
            createRope({ x: 400, y: 110, body: anchor }, { x: 400, y: 330, body: weight });

            Matter.Runner.run(App.runner, App.engine);
            App.isSimulating = true;
            console.log('‚úÖ Test running!');
        }

        function testGridAlignment() {
            clearScene();
            console.log('üß™ Running: Grid Alignment Test');
            const cfg = ObjectConfig;

            const objects = [
                Matter.Bodies.circle(200, 200, cfg.pulley.radius, {
                    isStatic: true,
                    render: { fillStyle: cfg.pulley.fillColor, strokeStyle: cfg.pulley.strokeColor, lineWidth: cfg.pulley.lineWidth },
                    label: 'pulley'
                }),
                Matter.Bodies.circle(400, 200, cfg.pulley.radius, {
                    isStatic: true,
                    render: { fillStyle: cfg.pulley.fillColor, strokeStyle: cfg.pulley.strokeColor, lineWidth: cfg.pulley.lineWidth },
                    label: 'pulley'
                }),
                Matter.Bodies.circle(600, 200, cfg.pulley.radius, {
                    isStatic: true,
                    render: { fillStyle: cfg.pulley.fillColor, strokeStyle: cfg.pulley.strokeColor, lineWidth: cfg.pulley.lineWidth },
                    label: 'pulley'
                }),
                Matter.Bodies.rectangle(300, 400, cfg.weight.size, cfg.weight.size, {
                    density: 0.1,
                    render: { fillStyle: cfg.weight.fillColor, strokeStyle: cfg.weight.strokeColor, lineWidth: cfg.weight.lineWidth },
                    label: 'weight'
                }),
                Matter.Bodies.rectangle(500, 400, cfg.weight.size, cfg.weight.size, {
                    density: 0.1,
                    render: { fillStyle: cfg.weight.fillColor, strokeStyle: cfg.weight.strokeColor, lineWidth: cfg.weight.lineWidth },
                    label: 'weight'
                })
            ];

            Matter.Composite.add(App.engine.world, objects);
            console.log('‚úÖ Objects placed at grid intersections (200, 400, 600)');
        }
    </script>
</body>

</html>